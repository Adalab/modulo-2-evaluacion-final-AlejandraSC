{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst searchButton = document.querySelector('.js-search__btn');\nconst request = document.querySelector('.js-inputText');\nconst results = document.querySelector('.results__container');\nconst deleteButton = document.querySelector('.deleteButton');\n\nlet series = [];\nlet seriesFav = [];\n\nfunction getData() {\n  const userValue = request.value;\n  fetch('//api.tvmaze.com/search/shows?q=' + userValue)\n    .then((response) => response.json())\n    .then((data) => {\n      cleanResultDiv(results);\n      series = data;\n      for (let i = 0; i < series.length; i++) {\n        const ind = getFavInd();\n        const id = series[i].show.id;\n        if (ind.indexOf(parseInt(series[i].show.id)) != -1) {\n          paintSerie(series[i], id, results, 'eachSerie__container', true);\n        } else {\n          paintSerie(series[i], id, results, 'eachSerie__container', false);\n        }\n      }\n      listenImages();\n    });\n}\n\nfunction paintSerie(serie, index, container, containerName, isFav) {\n  const tittle = createTitle(serie.show.name);\n  const img = createImg(serie);\n  const divContainer = createDiv(tittle, img, index, containerName, isFav);\n  container.appendChild(divContainer);\n  return divContainer;\n}\n\nfunction listenImages() {\n  const seriesImg = document.querySelectorAll('.eachSerie__container');\n  for (const serieImg of seriesImg) {\n    serieImg.addEventListener('click', favSeries);\n  }\n}\n\nfunction favSeries(ev) {\n  console.log(ev.currentTarget);\n\n  const serieToInclude = series.find((name) => name.show.id == ev.currentTarget.id);\n  const id = serieToInclude.show.id;\n\n  let ind = getFavInd();\n\n  if (ind.indexOf(parseInt(id)) == -1) {\n    seriesFav.push(serieToInclude);\n    const favContainer = document.querySelector('.fav__container');\n    const containerAddedToFav = paintSerie(serieToInclude, id, favContainer, 'eachSerieFav__container');\n    containerAddedToFav.addEventListener('click', removeFav);\n    localStorage.removeItem('favSeries');\n    if (seriesFav.length > 0) {\n      setLocalStorage(seriesFav);\n    }\n    ev.currentTarget.classList.add('alreadyFav');\n  }\n}\n\nfunction getFavInd() {\n  let ind = [];\n  for (let serieFav of seriesFav) {\n    ind.push(parseInt(serieFav.show.id));\n  }\n  return ind;\n}\n\nfunction removeFav(ev) {\n  ev.currentTarget.remove();\n  //Creamos un array de indices auxiliar para ver que IDs tenemos y hacer un indexOf\n  let ind = getFavInd();\n\n  const serieToRemove = ind.indexOf(parseInt(ev.currentTarget.id));\n  seriesFav.splice(serieToRemove, 1);\n  localStorage.removeItem('favSeries');\n  if (seriesFav.length > 0) {\n    setLocalStorage(seriesFav);\n  }\n\n  const eachSerie__containers = document.querySelectorAll('.eachSerie__container');\n  for (const container of eachSerie__containers) {\n    if (container.id == parseInt(ev.currentTarget.id)) {\n      container.classList.remove('alreadyFav');\n    }\n  }\n}\n\nfunction setLocalStorage(seriesFav) {\n  localStorage.setItem('favSeries', JSON.stringify(seriesFav));\n}\n\nfunction getLocalStorage() {\n  const localfavSeries = localStorage.getItem('favSeries');\n  const localfavSeriesJson = JSON.parse(localfavSeries);\n  if (localfavSeriesJson === null) {\n    getData();\n  } else {\n    seriesFav = localfavSeriesJson;\n    paintLocalstoreSeries();\n  }\n}\n\nfunction paintLocalstoreSeries() {\n  for (let serie of seriesFav) {\n    const favContainer = document.querySelector('.fav__container');\n    const containerAddedToFav = paintSerie(serie, serie.show.id, favContainer, 'eachSerieFav__container', false);\n    containerAddedToFav.addEventListener('click', removeFav);\n  }\n}\n\nfunction createImg(serie) {\n  const resultImg__container = document.createElement('img');\n  resultImg__container.classList.add('resultImg');\n  resultImg__container.classList.add('js-resultImg');\n  //seleccionamos la imagen, si no existe creamos una con el nombre\n  if (serie.show.image) {\n    resultImg__container.src = serie.show.image.original;\n  } else {\n    resultImg__container.src = '//via.placeholder.com/210x295/ffffff/666666/?text=' + serie.show.name;\n  }\n  return resultImg__container;\n}\n\nfunction createTitle(name) {\n  const resultTitle__paragr = document.createElement('p');\n  resultTitle__paragr.classList.add('resultTitle');\n  const resultTitle__content = document.createTextNode(name);\n  resultTitle__paragr.appendChild(resultTitle__content);\n  return resultTitle__paragr;\n}\n\nfunction createDiv(title, img, index, containerName, isFav) {\n  const eachSerie__container = document.createElement('div');\n  eachSerie__container.classList.add(containerName);\n  if (isFav) {\n    eachSerie__container.classList.add('alreadyFav');\n  }\n  eachSerie__container.id = index;\n  eachSerie__container.appendChild(img);\n  eachSerie__container.appendChild(title);\n\n  return eachSerie__container;\n}\n\nfunction cleanResultDiv(divToclean) {\n  while (divToclean.firstChild) {\n    divToclean.removeChild(divToclean.firstChild);\n  }\n}\n\nfunction deleteFav() {\n  console.log('Is working');\n  localStorage.removeItem('favSeries');\n  seriesFav = [];\n  const favContainer = document.querySelector('.fav__container');\n  cleanResultDiv(favContainer);\n\n  const eachSerie__containers = document.querySelectorAll('.eachSerie__container');\n  for (const container of eachSerie__containers) {\n    container.classList.remove('alreadyFav');\n  }\n}\n\nsearchButton.addEventListener('click', getData);\ndeleteButton.addEventListener('click', deleteFav);\n\ngetLocalStorage();\n"]}